import{z as t,h as e,p as o,$ as a}from"./nitro.mjs";const s=new Map;async function requireNuxtHubAuthorization(r){const i=(t(r,"authorization")||"").split(" ")[1];if(!i)throw e({statusCode:403,message:"Missing Authorization header"});const n=r.context.cloudflare?.env||o.env||{},u=n.NUXT_HUB_PROJECT_KEY,h=n.NUXT_HUB_PROJECT_SECRET_KEY;if(!h||i!==h){if(h&&!u)throw e({statusCode:401,message:"Invalid secret key"});if(u){if(s.has(i))return;return await a(`/api/projects/${u}`,{baseURL:n.NUXT_HUB_URL||"https://admin.hub.nuxt.com",method:"HEAD",headers:{authorization:`Bearer ${i}`}}).catch((()=>{throw e({statusCode:401,message:"Could not connect to project"})})),void s.set(i,!0)}throw e({statusCode:401,message:"Missing NUXT_HUB_PROJECT_SECRET_KEY environment variable or NUXT_HUB_PROJECT_KEY environment variable"})}}export{requireNuxtHubAuthorization as r};
//# sourceMappingURL=auth.mjs.map
